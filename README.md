# Python Films - Система поиска фильмов

Интерактивное консольное приложение для поиска фильмов из базы данных Sakila (MySQL). Приложение предоставляет удобный интерфейс, логирование запросов в MongoDB и детальную статистику.

## Ключевые возможности

- **Поиск по ключевому слову** — поиск в названиях фильмов
- **Фильтрация по жанру** — выбор из списка доступных жанров
- **Диапазон годов** — поиск фильмов по годам выпуска
- **Фильтр по возрастным категориям** — выбор категории с включением более мягких категорий
- **Просмотр актёров** — детальная информация об актёрах выбранного фильма
- **Фильмы актёра** — просмотр всех фильмов с участием выбранного актёра
- **Избранное** — сохранение фильмов в JSON-файл для быстрого доступа
- **Логирование запросов** — автоматическое сохранение в MongoDB
- **Статистика** — популярные и недавние запросы
- **Управление данными** — очистка логов и избранного
- **Удобный интерфейс** — форматирование с разделителями

## Структура проекта

```
Project/
├── main.py                 # Главный модуль с меню приложения
├── searches.py             # Интерактивные функции поиска фильмов
├── mysql_connector.py      # Подключение к MySQL и SQL-запросы
├── mongo_client.py         # Клиент MongoDB для логирования
├── log_stats.py            # Статистика и очистка логов запросов
├── favorites.py            # Управление избранными фильмами
├── formatter.py            # Форматирование вывода в консоль
├── input_utils.py          # Вспомогательные функции ввода
├── config.py               # Конфигурация из переменных окружения
├── .env                    # Конфигурационный файл (не в Git, есть .env.example)
└── favorites.json          # Файл с избранными фильмами
```

## Требования

- **Python 3.10+** (разработано и протестировано на Python 3.12)
- **MySQL Server** с базой данных Sakila
- **MongoDB** (опционально - для логирования)

**Основные библиотеки:**
- `pymysql` — подключение к MySQL
- `pymongo` — работа с MongoDB
- `python-dotenv` — загрузка переменных окружения

### Примечания по конфигурации

- **MySQL обязателен** — без него приложение не запустится
- **MongoDB опционален** — если недоступен, логирование отключается автоматически
- **LIMIT** — количество результатов на странице (по умолчанию 10)
- Порядок рейтингов настраивается в `config.py` через `RATING_ORDER`

## Запуск приложения

```powershell
# Перейдите в директорию проекта
cd 'Абсолютный путь вашей директории проекта'

# Запустите приложение
python main.py
```

### Главное меню

```
 ГЛАВНОЕ МЕНЮ
  1.  Поиск по ключевому слову
  2.  Поиск по жанру и/или диапазону лет
  3.  Показать статистику запросов
  4.  Очистить логи MongoDB
  5.  Просмотр избранного
  6.  Очистить избранное
  q.  Выход
```

### Поиск по ключевому слову

```
 Выберите опцию: 1

 ПОИСК ПО КЛЮЧЕВОМУ СЛОВУ

 Введите ключевое слово: matrix

 Фильтровать по жанру? (y/n): n

 Доступные годы: 2006 — 2006
 Нижний год (Enter для 2006): [Enter]
 Верхний год (Enter для 2006): [Enter]

 Доступные рейтинги:
  1. G — Для всей аудитории
  2. PG — Рекомендуется родительский контроль
  ...
 Выберите номер рейтинга (или Enter для пропуска): [Enter]

 Найдено всего: 3 фильм(ов)

 РЕЗУЛЬТАТЫ ПОИСКА

  1.  ACADEMY DINOSAUR (2006)
       Аренда: $0.99 | Покупка: $20.99
       Рейтинг: PG
       A Epic Drama of a Feminist...

  f.  Добавить фильм в избранное
  n.  Следующая страница | p. Предыдущая страница | q. Назад в меню

 Введите номер фильма или команду: 
```

### Поиск по жанру и годам

```
 Выберите опцию: 2

 ПОИСК ПО ЖАНРУ И ГОДАМ

 ДОСТУПНЫЕ ЖАНРЫ
  1. Action              
  2. Animation           
  ...

 Выберите номер жанра: 1

 Доступные годы: 2006 — 2006
 Нижний год: 2006
 Верхний год: 2006
```

### Просмотр фильмов актёра

```
Введите номер фильма для просмотра актёров: 1

 АКТЁРЫ ФИЛЬМА: ACADEMY DINOSAUR
  1. Christian Gable
  2. Lucille Tracy
  3. Sandra Peck
  ...

 Хотите посмотреть фильмы одного из актёров? (y/n): y

 Введите номер актёра (1-10) или Enter для отмены: 1

 ФИЛЬМЫ С УЧАСТИЕМ: Christian Gable

 Всего фильмов с участием актёра: 15

  1.  ADAPTATION HOLES (2006)
       Аренда: $2.99 | Покупка: $19.99
       Рейтинг: NC-17
       A Astounding Reflection of a Lumberjack...
  
  2.  APOCALYPSE FLAMINGOS (2006)
       Аренда: $4.99 | Покупка: $11.99
       Рейтинг: R
      ...
```

### Просмотр статистики

```
➤ Выберите опцию: 3

 ПОПУЛЯРНЫЕ ЗАПРОСЫ
  1. Поиск по ключевому слову
     Параметры: ключевое слово: 'matrix'
     Количество запросов: 5
     Последний запрос: 2025-11-25T14:30:00

 НЕДАВНИЕ ЗАПРОСЫ
  1. [2025-11-25T14:30:00] Поиск по ключевому слову
     Параметры: ключевое слово: 'love'
     Найдено результатов: 12
```

### Стандарты кодирования

- **PEP 8**
- **Документация**
- **Модульность**
- **Обработка ошибок**
- **Конфигурация**

##  Структура базы данных

### MySQL (Sakila)
- `film` — информация о фильмах
- `category` — жанры
- `film_category` — связь фильмов и жанров
- `film_actor` — связь фильмов и актёров
- `actor` — информация об актёрах

### MongoDB (Логи)
```json
{
  "timestamp": "2025-11-25T14:30:00",
  "search_type": "keyword",
  "params": {
    "keyword": "matrix",
    "genre_id": 1,
    "year_min": 2006,
    "year_max": 2006,
    "rating": "PG-13"
  },
  "results_count": 3
}
```

### JSON (Избранное)
```json
[
  {
    "film_id": 1,
    "title": "ACADEMY DINOSAUR",
    "release_year": 2006,
    "rating": "PG",
    "rental_rate": 0.99,
    "replacement_cost": 20.99,
    "description": "A Epic Drama of a Feminist..."
  }
]
```

## Дальнейшие улучшения

### Реализованные функции 
- [x] Поиск по ключевому слову
- [x] Фильтрация по жанру, годам, рейтингу
- [x] Просмотр актёров фильма
- [x] Просмотр фильмов актёра
- [x] Избранное (сохранение в JSON, просмотр, очистка)
- [x] Логирование запросов в MongoDB
- [x] Статистика популярных и недавних запросов
- [x] Управление логами (очистка)

### Возможные расширения 
- [ ] Сортировка результатов (по названию, году, рейтингу)
- [ ] Экспорт результатов в CSV/JSON
- [ ] Детальная информация о фильме (язык, специальные функции)
- [ ] Поиск по описанию фильма (полнотекстовый поиск)
- [ ] Web-интерфейс (Flask/FastAPI)

## Автор

**Oleksandr Veremeienko**

## Лицензия

Этот проект создан в образовательных целях.

---

**Приятного использования!**
