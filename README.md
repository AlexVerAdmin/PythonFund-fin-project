# Python_films

Консольное приложение для поиска фильмов (набор данных Sakila). Позволяет выполнять поиск по ключевым словам, фильтровать по жанру/диапазону годов и рейтингу, логировать запросы в MongoDB и просматривать статистику.

**Ключевые возможности**
- Поиск по ключевому слову в названии/описании
- Фильтрация по жанру и диапазону годов
- Фильтр по рейтингу (включительно: выбранный и "мягче")
- Вывод `rental_rate` и `replacement_cost` в списке результатов
- Логирование запросов в MongoDB (`timestamp` + `user_params` без `offset`)
- Просмотр статистики и очистка логов

**Файлы проекта**
- `main.py` — CLI и сценарии взаимодействия с пользователем
- `mysql_connector.py` — функции доступа к MySQL (Sakila)
- `log_writer.py`, `log_stats.py` — запись логов и агрегаты в MongoDB
- `mongo_client.py` — централизованный клиент Mongo с безопасным no-op fallback
- `formatter.py` — вывод результатов в консоль
- `config.py` — чтение конфигурации из окружения (`.env`)

**Требования**
- Python 3.10+ (разрабатывалось и тестировалось на 3.12)
- Зависимости описаны в `requirements.txt`. Установка:

```powershell
python -m pip install -r requirements.txt
```

**Конфигурация**
Скопируйте пример файла окружения и заполните значения перед запуском:

```text
# .env.example
MYSQL_HOST=127.0.0.1
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASS=secret
MYSQL_DB=sakila

MONGO_URI=mongodb://user:pass@localhost:27017
MONGO_DB=python_films
MONGO_COLLECTION=search_logs

# Порядок рейтингов (через запятую) — от "жёсткого" к "мягкому"
RATINGS_ORDER=NC-17,R,PG-13,PG,G
```

Примечания:
- MongoDB не является критичным: если `MONGO_URI` не задан или некорректен, приложение включает no-op режим логирования (логи не будут записываться, но поиск — работать).

**Запуск**
В каталоге проекта выполните:

```powershell
Set-Location 'D:\ICH\Python\Project_VSC'
python main.py
```

**Примеры использования (в программе)**
- При поиске по ключевому слову приложение попросит ввести `keyword`.
- Можно дополнительно выбрать жанр, диапазон годов и рейтинг.
- После формирования критериев запрос логируется в Mongo (один документ — без пагинационных offset).
- В меню есть пункт очистки логов (с подтверждением).

**Разработка и проверки качества**
- Форматирование: `black` (рекомендуется)
- Статический анализ: `flake8`

Пример быстрой проверки:
```powershell
python -m pip install black flake8
black .
flake8 .
```

**Git / Ветка**
- Код зафиксирован в ветке `projectPython` и запушен в `https://github.com/AlexVerAdmin/Python_films`.

**Дальше (рекомендации)**
- Добавить `README.md` более развернутый с примерами запросов и примерами вывода (по желанию).
- Настроить CI (GitHub Actions) для линтинга и тестов.

Если хотите, я могу добавить более подробный раздел «Тесты» и пример `.env.example` как файл в репозитории.
